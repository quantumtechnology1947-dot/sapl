{% extends 'material_costing/base.html' %}
{% block title %}Comparative Cost Report{% endblock %}
{% block content %}
<div class="mb-6">
    <h2 class="text-sm font-bold text-gray-900">Comparative Cost Report</h2>
</div>
<div class="bg-white rounded border border-gray-200 p-6 mb-6">
    <form method="get" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Period 1 (From - To)</label>
            <div class="flex space-x-2">
                <input type="date" name="period1_from" value="{{ request.GET.period1_from }}" class="flex-1 px-4 py-2 border rounded">
                <input type="date" name="period1_to" value="{{ request.GET.period1_to }}" class="flex-1 px-4 py-2 border rounded">
            </div>
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Period 2 (From - To)</label>
            <div class="flex space-x-2">
                <input type="date" name="period2_from" value="{{ request.GET.period2_from }}" class="flex-1 px-4 py-2 border rounded">
                <input type="date" name="period2_to" value="{{ request.GET.period2_to }}" class="flex-1 px-4 py-2 border rounded">
            </div>
        </div>
        <div class="flex items-end">
            <button type="submit" class="w-full px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Compare</button>
        </div>
    </form>
</div>
<div class="bg-white rounded border border-gray-200 p-6">
    {% if comparison_data %}
    <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Item</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Period 1 Cost</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Period 2 Cost</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Variance</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">% Change</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for item in comparison_data %}
                <tr>
                    <td class="px-6 py-4 text-sm">{{ item.itemid }}</td>
                    <td class="px-6 py-4 text-sm">{{ item.period1_cost }}</td>
                    <td class="px-6 py-4 text-sm">{{ item.period2_cost }}</td>
                    <td class="px-6 py-4 text-sm">{{ item.variance }}</td>
                    <td class="px-6 py-4 text-sm {% if item.percent_change > 0 %}text-red-600{% else %}text-green-600{% endif %}">{{ item.percent_change }}%</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <p class="text-gray-500 text-center">No comparison data available. Please select both periods and generate report.</p>
    {% endif %}
</div>
{% endblock %}








