{# Reusable Cascading Location Dropdowns (Country -> State -> City) #}
{# Usage: {% include 'core/components/location_dropdowns.html' with field_prefix='regd' show_country=True %} #}

{% load static %}

{# Country Dropdown #}
{% if show_country|default:True %}
<div class="mb-4" id="{{ field_prefix|default:'regd' }}country-container">
    <label for="id_{{ field_prefix|default:'regd' }}country" class="block text-sm font-medium text-gray-700 mb-2">
        Country {% if required|default:True %}<span class="text-red-500">*</span>{% endif %}
    </label>
    <select name="{{ field_prefix|default:'regd' }}country"
            id="id_{{ field_prefix|default:'regd' }}country"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sap-blue"
            hx-get="{% url 'sys_admin:states-by-country' %}"
            hx-trigger="change"
            hx-target="#{{ field_prefix|default:'regd' }}state-container"
            hx-include="[name='{{ field_prefix|default:'regd' }}country']"
            {% if required|default:True %}required{% endif %}>
        <option value="">Select Country</option>
        {% for country in countries %}
        <option value="{{ country.cid }}" {% if selected_country == country.cid|stringformat:"s" %}selected{% endif %}>
            {{ country.countryname }}
        </option>
        {% endfor %}
    </select>
</div>
{% endif %}

{# State Dropdown #}
<div class="mb-4" id="{{ field_prefix|default:'regd' }}state-container">
    <label for="id_{{ field_prefix|default:'regd' }}state" class="block text-sm font-medium text-gray-700 mb-2">
        State {% if required|default:True %}<span class="text-red-500">*</span>{% endif %}
    </label>
    <select name="{{ field_prefix|default:'regd' }}state"
            id="id_{{ field_prefix|default:'regd' }}state"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sap-blue"
            hx-get="{% url 'sys_admin:cities-by-state' %}"
            hx-trigger="change"
            hx-target="#{{ field_prefix|default:'regd' }}city-container"
            hx-include="[name='{{ field_prefix|default:'regd' }}state']"
            {% if required|default:True %}required{% endif %}>
        <option value="">Select State</option>
        {% for state in states %}
        <option value="{{ state.sid }}" {% if selected_state == state.sid|stringformat:"s" %}selected{% endif %}>
            {{ state.statename }}
        </option>
        {% endfor %}
    </select>
</div>

{# City Dropdown #}
<div class="mb-4" id="{{ field_prefix|default:'regd' }}city-container">
    <label for="id_{{ field_prefix|default:'regd' }}city" class="block text-sm font-medium text-gray-700 mb-2">
        City {% if required|default:True %}<span class="text-red-500">*</span>{% endif %}
    </label>
    <select name="{{ field_prefix|default:'regd' }}city"
            id="id_{{ field_prefix|default:'regd' }}city"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sap-blue"
            {% if required|default:True %}required{% endif %}>
        <option value="">Select City</option>
        {% for city in cities %}
        <option value="{{ city.cityid }}" {% if selected_city == city.cityid|stringformat:"s" %}selected{% endif %}>
            {{ city.cityname }}
        </option>
        {% endfor %}
    </select>
</div>








