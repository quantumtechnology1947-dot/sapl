# Playwright Test Templates

This directory contains Playwright test templates for the ASP.NET to Django migration.

## Overview

- **Total Test Files:** 53
- **Coverage:** All Django apps with existing modules
- **Status:** Templates (need implementation)

## Generated Test Files

Test files are organized by Django app and category:

```
test_{app}_{category}.py
```

Examples:
- `test_sales_distribution_masters.py` - Sales Distribution master data tests
- `test_inventory_transactions.py` - Inventory transaction tests
- `test_accounts_reports.py` - Accounts reports tests

## Generating Test Templates

Test templates are auto-generated by the migration tooling:

```bash
# Generate all test templates
python playwright_test_generator.py
```

This will:
1. Analyze `aspx_django_mapping.csv`
2. Generate test templates for unmigrated features
3. Create one test file per app/category combination

## Running Tests

```bash
# Run all Playwright tests
pytest tests/playwright/ -v

# Run specific module tests
pytest tests/playwright/test_sales_distribution_masters.py -v

# Run in headed mode (see browser)
pytest tests/playwright/ -v --headed

# Run with specific markers
pytest -m smoke -v
pytest -m htmx -v
pytest -m crud -v
```

## Test Structure

Each generated test file contains:

1. **Fixtures** - Authentication, database setup
2. **Test Classes** - Organized by feature
3. **Test Methods:**
   - `test_list_view_loads()` - Verify list page
   - `test_create_new_record()` - Test creation
   - `test_edit_existing_record()` - Test updates
   - `test_delete_record()` - Test deletion
   - `test_search_functionality()` - Test filtering
   - `test_htmx_partial_update()` - Test HTMX
   - `test_form_validation()` - Test validation
   - `test_pagination()` - Test pagination

## Implementing Tests

To implement a test template:

1. **Review ASP.NET Source**
   - Check `aspx_django_mapping.csv` for ASPX file path
   - Review original functionality in `aaspnet/Module/`

2. **Update URLs**
   - Replace placeholder URLs with actual Django routes
   - Verify URL patterns in app's `urls.py`

3. **Fill Form Selectors**
   - Add actual field IDs from templates
   - Add button selectors
   - Add element locators

4. **Add Assertions**
   - Verify success messages
   - Check data persistence
   - Validate UI elements

5. **Create Test Data**
   - Use fixtures from `csv_data/`
   - Create factory functions if needed

## Test Markers

Use pytest markers to categorize tests:

```python
@pytest.mark.smoke      # Critical path tests
@pytest.mark.htmx       # HTMX interaction tests
@pytest.mark.crud       # CRUD operation tests
@pytest.mark.slow       # Long-running tests
```

## Example Implementation

Before (template):
```python
def test_create_new_record(self, authenticated_page: Page):
    # TODO: Navigate to create view
    authenticated_page.goto("http://localhost:8000/{module}/{test_name}/create/")

    # TODO: Fill form fields
    # authenticated_page.fill("#id_field_name", "Test Value")
```

After (implemented):
```python
def test_create_customer(self, authenticated_page: Page):
    """Test creating a new customer"""
    authenticated_page.goto("http://localhost:8000/sales_distribution/customer/create/")

    # Fill customer form
    authenticated_page.fill("#id_custname", "Test Customer Ltd")
    authenticated_page.fill("#id_address", "123 Test Street")
    authenticated_page.fill("#id_city", "Mumbai")
    authenticated_page.select_option("#id_country", "India")

    # Submit
    authenticated_page.click("button[type=submit]")

    # Verify success
    expect(authenticated_page.locator(".alert-success")).to_contain_text("Customer created successfully")
```

## Coverage Tracking

Check test coverage:

```bash
# Run migration tracker
python migration_tracker.py stats

# Check specific module
python migration_tracker.py module sales_distribution
```

## CI/CD Integration

Tests are designed to run in CI/CD pipelines:

```yaml
# Example GitHub Actions workflow
- name: Run Playwright Tests
  run: |
    python manage.py migrate
    pytest tests/playwright/ -v --headed=false
```

## Notes

- ⚠️ Test templates use placeholder URLs and selectors
- ⚠️ You must implement actual test logic for each feature
- ⚠️ Test files may be ignored by .gitignore (test_*.py pattern)
- ✅ Use `playwright_test_generator.py` to regenerate after updates

## Resources

- [Playwright Python Documentation](https://playwright.dev/python/)
- [pytest Documentation](https://docs.pytest.org/)
- [Django Testing Documentation](https://docs.djangoproject.com/en/stable/topics/testing/)

---

**Last Generated:** Auto-generated by `playwright_test_generator.py`
**Template Count:** 53 files
**Total Features Covered:** 941 .aspx files
