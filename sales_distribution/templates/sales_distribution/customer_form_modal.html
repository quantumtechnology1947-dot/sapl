<!-- Modal Header -->
<div class="bg-gray-50 px-4 py-3 border-b border-gray-200">
    <div class="flex items-center justify-between">
        <h3 class="text-lg font-medium text-gray-900">
            {% if form.instance.pk %}Edit Customer{% else %}New Customer{% endif %}
        </h3>
        <button onclick="closeModal()" class="text-gray-400 hover:text-gray-500">
            <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>
    </div>
</div>

<!-- Modal Body -->
<div class="px-2 py-2 max-h-[70vh] overflow-y-auto">
    <form method="post" id="customer-modal-form"
          hx-post="{% url 'sales_distribution:customer-create' %}"
          hx-target="#modal-content">
        {% csrf_token %}

        <!-- Customer Name Row -->
        <div class="bg-white border border-gray-300 mb-2">
            <table class="w-full">
                <tr>
                    <td class="px-2 py-1 text-xs font-medium text-gray-700 bg-gray-50" class="w-[17%]">
                        Customer's Name <span class="text-red-500">*</span>
                    </td>
                    <td colspan="2" class="px-2 py-1">
                        {{ form.customername }}
                        {% if form.customername.errors %}
                        <span class="text-red-500 text-xs ml-1">{{ form.customername.errors.0 }}</span>
                        {% endif %}
                    </td>
                    <td class="px-2 py-1" class="w-[100px]"></td>
                </tr>
            </table>
        </div>

        <!-- 3-Column Address Section -->
        <div class="bg-white border border-gray-300 mb-2">
            <table class="w-full border-collapse text-xs">
                <thead>
                    <tr class="bg-gray-100">
                        <th class="border border-gray-300 px-2 py-1 text-left text-xs font-semibold text-gray-700" class="w-[17%]">
                            Address/Details
                        </th>
                        <th class="border border-gray-300 px-2 py-1 text-center text-xs font-semibold text-gray-700" class="w-[27%]">
                            REGD. OFFICE
                        </th>
                        <th class="border border-gray-300 px-2 py-1 text-center text-xs font-semibold text-gray-700" class="w-[28%]">
                            WORKS/FACTORY
                        </th>
                        <th class="border border-gray-300 px-2 py-1 text-center text-xs font-semibold text-gray-700" class="w-[28%]">
                            MATERIAL DELIVERY
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Address Row -->
                    <tr>
                        <td class="border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700 bg-gray-50">
                            Address <span class="text-red-500">*</span>
                        </td>
                        <td class="border border-gray-300 px-1 py-1">
                            {{ form.regdaddress }}
                        </td>
                        <td class="border border-gray-300 px-1 py-1">
                            {{ form.workaddress }}
                        </td>
                        <td class="border border-gray-300 px-1 py-1">
                            {{ form.materialdeladdress }}
                        </td>
                    </tr>

                    <!-- Country Row -->
                    <tr>
                        <td class="border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700 bg-gray-50">
                            Country <span class="text-red-500">*</span>
                        </td>
                        <td class="border border-gray-300 px-1 py-1">
                            {{ form.regdcountry }}
                        </td>
                        <td class="border border-gray-300 px-1 py-1">
                            {{ form.workcountry }}
                        </td>
                        <td class="border border-gray-300 px-1 py-1">
                            {{ form.materialdelcountry }}
                        </td>
                    </tr>

                    <!-- State Row -->
                    <tr>
                        <td class="border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700 bg-gray-50">
                            State <span class="text-red-500">*</span>
                        </td>
                        <td class="border border-gray-300 px-1 py-1" id="regdstate-container">
                            {{ form.regdstate }}
                        </td>
                        <td class="border border-gray-300 px-1 py-1" id="workstate-container">
                            {{ form.workstate }}
                        </td>
                        <td class="border border-gray-300 px-1 py-1" id="materialdelstate-container">
                            {{ form.materialdelstate }}
                        </td>
                    </tr>

                    <!-- City Row -->
                    <tr>
                        <td class="border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700 bg-gray-50">
                            City <span class="text-red-500">*</span>
                        </td>
                        <td class="border border-gray-300 px-1 py-1" id="regdcity-container">
                            {{ form.regdcity }}
                        </td>
                        <td class="border border-gray-300 px-1 py-1" id="workcity-container">
                            {{ form.workcity }}
                        </td>
                        <td class="border border-gray-300 px-1 py-1" id="materialdelcity-container">
                            {{ form.materialdelcity }}
                        </td>
                    </tr>

                    <!-- PIN No. Row -->
                    <tr>
                        <td class="border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700 bg-gray-50">
                            PIN No. <span class="text-red-500">*</span>
                        </td>
                        <td class="border border-gray-300 px-1 py-1">
                            {{ form.regdpinno }}
                        </td>
                        <td class="border border-gray-300 px-1 py-1">
                            {{ form.workpinno }}
                        </td>
                        <td class="border border-gray-300 px-1 py-1">
                            {{ form.materialdelpinno }}
                        </td>
                    </tr>

                    <!-- Contact No. Row -->
                    <tr>
                        <td class="border border-gray-300 px-2 py-1 text-xs font-medium text-gray-700 bg-gray-50">
                            Contact No. <span class="text-red-500">*</span>
                        </td>
                        <td class="border border-gray-300 px-1 py-1">
                            {{ form.regdcontactno }}
                        </td>
                        <td class="border border-gray-300 px-1 py-1">
                            {{ form.workcontactno }}
                        </td>
                        <td class="border border-gray-300 px-1 py-1">
                            {{ form.materialdelcontactno }}
                        </td>
                    </tr>

                    <!-- Additional Fields Section (matching old form layout) -->
                    <tr>
                        <td colspan="4" class="border border-gray-300 px-0 py-0">
                            <table class="w-full text-xs">
                                <!-- Row 1: Contact Person, Email, Contact No -->
                                <tr>
                                    <td class="px-2 py-1 font-medium text-gray-700" class="w-[17%]">Contact Person <span class="text-red-500">*</span></td>
                                    <td class="px-1 py-1" class="w-[21%]">{{ form.contactperson }}</td>
                                    <td class="px-2 py-1 font-medium text-gray-700" class="w-[10%]">E-mail <span class="text-red-500">*</span></td>
                                    <td class="px-1 py-1" class="w-[20%]">{{ form.email }}</td>
                                    <td class="px-2 py-1 font-medium text-gray-700" class="w-[10%]">Contact No. <span class="text-red-500">*</span></td>
                                    <td class="px-1 py-1" class="w-[22%]">{{ form.contactno }}</td>
                                </tr>
                                <!-- Row 2: GST No -->
                                <tr>
                                    <td class="px-2 py-1 font-medium text-gray-700">GST No. <span class="text-red-500">*</span></td>
                                    <td colspan="5" class="px-1 py-1">{{ form.tincstno }}</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Remarks Row -->
        <div class="bg-white border border-gray-300 mb-2">
            <table class="w-full text-xs">
                <tr>
                    <td class="px-2 py-1 font-medium text-gray-700 bg-gray-50" class="w-[17%]">
                        Remarks
                    </td>
                    <td colspan="2" class="px-2 py-1">
                        {{ form.remark }}
                        {% if form.remark.errors %}
                        <span class="text-red-500 text-xs ml-1">{{ form.remark.errors.0 }}</span>
                        {% endif %}
                    </td>
                    <td class="w-[100px]"></td>
                </tr>
            </table>
        </div>
    </form>
</div>

<!-- Modal Footer -->
<div class="bg-gray-50 px-4 py-3 border-t border-gray-200 flex justify-end space-x-2">
    <button type="button" onclick="closeModal()"
            class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50">
        Cancel
    </button>
    <button type="submit" form="customer-modal-form"
            class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700">
        Save Customer
    </button>
</div>

<script>
function closeModal() {
    document.getElementById('modal').classList.add('hidden');
}

// Listen for successful customer creation
document.body.addEventListener('customerCreated', function() {
    closeModal();
    // Reload the customer list
    window.location.reload();
});

// Show modal when content is loaded
document.getElementById('modal').classList.remove('hidden');

// Process HTMX elements in the modal
htmx.process(document.getElementById('modal-content'));
</script>









